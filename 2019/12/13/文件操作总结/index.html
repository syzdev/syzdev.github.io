<!DOCTYPE html><html lang="zh-CN" color-mode="light"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content=""><meta name="author" content="syz"><meta name="description" content=""><title>文件操作总结 | syzdev</title><link rel="apple-touch-icon" href="https://cdn.u1.huluxia.com/g3/M03/4D/84/wKgBOV6fGZWATbp6AAAML1Rr8NY150.png"><link rel="icon" href="https://cdn.u1.huluxia.com/g3/M03/4D/84/wKgBOV6fGZWATbp6AAAML1Rr8NY150.png"><link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/color-scheme.css"><link rel="stylesheet" href="/css/base.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1886449_67xjft27j1l.css"><link rel="stylesheet" href="/css/github-markdown.css"><link rel="stylesheet" href="/css/highlight.css"><link rel="stylesheet" href="/css/comments.css"><link rel="stylesheet" href="/css/figcaption/mac-block.css"><script defer type="text/javascript" src="/plugins/jquery.min.js"></script><link href="/plugins/jquery.fancybox.min.css" rel="stylesheet"><script defer type="text/javascript" src="/plugins/jquery.fancybox.min.js"></script><script src="/js/fancybox.js"></script><script>var html=document.documentElement;const colorMode=localStorage.getItem("color-mode");colorMode&&document.documentElement.setAttribute("color-mode",colorMode)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="app"><div class="header"><div class="avatar"><a href="/"><img src="/images/avatar.png" alt=""></a><div class="nickname"><a href="/">syzdev</a></div></div><div class="navbar"><ul><li class="nav-item" data-path="/"><a href="/">首页</a></li><li class="nav-item" data-path="/archives/"><a href="/archives/">归档</a></li><li class="nav-item" data-path="/tags/"><a href="/tags/">标签</a></li><li class="nav-item" data-path="/about/"><a href="/about/">关于</a></li></ul></div></div><script src="/js/activeNav.js"></script><div class="flex-container"><script async type="text/javascript" src="/plugins/mathjax/tex-chtml.js"></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script async type="text/javascript" src="/plugins/clipboard.min.js"></script><script src="/js/codeCopy.js"></script><div class="container post-details" id="post-details"><div class="post-content"><div class="post-title">文件操作总结</div><div class="post-attach"><span class="post-pubtime"><i class="iconfont icon-updatetime" title="更新时间"></i> 2019-12-13 19:36:40 </span><span class="post-tags"><i class="iconfont icon-tags" title="标签"></i> <span class="span--tag"><a href="/tags/C%E8%AF%AD%E8%A8%80/" title="C语言"><b>#</b> C语言</a></span></span></div><div class="markdown-body"><h1 id="1-fopen文件操作方式"><a class="markdownIt-Anchor" href="#1-fopen文件操作方式"></a> 1 fopen文件操作方式</h1><table><thead><tr><th>操作方式</th><th>含义</th><th>如果指定文件不存在</th></tr></thead><tbody><tr><td>“r”只读</td><td>为了输入数据，打开一个已存在的文本文件</td><td>出错</td></tr><tr><td>“w”只写</td><td>为了输出数据，打开一个文本文件（清空）</td><td>建立新文件</td></tr><tr><td>“a”追加</td><td>向文本文件末尾添加数据</td><td>出错</td></tr><tr><td>“rb”只读</td><td>为了输入数据，打开一个已存在的二进制文件</td><td>出错</td></tr><tr><td>“wb”只读</td><td>为了输出数据，打开一个二进制文件（清空）</td><td>建立新文件</td></tr><tr><td>“ab”追加</td><td>向二进制文件末尾添加数据</td><td>出错</td></tr><tr><td>“r+”读写</td><td>为了读和写，打开一个文本文件</td><td>出错</td></tr><tr><td>“w+”读写</td><td>为了读和写，打开一个文本文件（清空）</td><td>建立新文件</td></tr><tr><td>“a+”读写</td><td>为了读和写，打开一个文本文件</td><td>出错</td></tr><tr><td>“rb+”读写</td><td>为了读和写，打开一个二进制文件</td><td>出错</td></tr><tr><td>“wb+”读写</td><td>为了读和写，打开一个二进制文件（清空）</td><td>建立新文件</td></tr><tr><td>“ab+”读写</td><td>为了读和写，打开一个二进制文件</td><td>出错</td></tr></tbody></table><ul><li>用“<code>r</code>”方式打开文件只能用于向计算机输入而不能用作向该文件输出数据（<strong>即读数据到变量中</strong>），若文件不存在会出错；</li><li>用“<code>w</code>”方式打开文件只能用于向该文件写数据（<strong>即往文件里写数据</strong>），而不能用来向计算机输入，如果原文件不存在，则创建该文件，若该文件已存在，则打开文件前将其删除，再重新创建一个；</li><li>若要向文件末尾添加数据（不希望删除原有数据），则使用“<code>a</code>”方式，文件不存在会出错；</li><li>带“<code>+</code>”的方式，既可用来输入数据，也可用来输出数据；</li><li>若以任意方式打开文件失败，<code>fopen</code> 函数会返回 <code>NULL；</code></li><li><strong>在以文本文件（ASCII）读入字符时，遇到回车换行符（<code>\r\n</code>），系统把它转换为一个换行符（<code>\n</code>），在输出时把换行符（<code>\n</code>）转换为回车（<code>\r</code>）和换行（<code>\n</code>）两个字符</strong>；</li><li><strong>在以二进制方式时，不进行上述转换，在内存中的数据形式与输出到外部文件中的数据形式完全一致，一一对应</strong>。</li></ul><h2 id="11-打开文件fopen"><a class="markdownIt-Anchor" href="#11-打开文件fopen"></a> 1.1 打开文件fopen</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FILE *fp = fopen(<span class="string">&quot;abc.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="12-关闭文件fclose"><a class="markdownIt-Anchor" href="#12-关闭文件fclose"></a> 1.2 关闭文件fclose</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fclose(fp); <span class="comment">// 关闭成功返回0，否则返回EOF(-1)</span></span><br></pre></td></tr></table></figure><h1 id="2-向文件读写字符"><a class="markdownIt-Anchor" href="#2-向文件读写字符"></a> 2 向文件读写字符</h1><h2 id="21-读字符fgetc"><a class="markdownIt-Anchor" href="#21-读字符fgetc"></a> 2.1 读字符fgetc</h2><p>函数原型 <code>int fgetc(FILE *stream)</code>：</p><ul><li>调用形式<code>ch = fgetc(fp)</code>；</li><li>从<code>fp</code>指向的文件读入一个字符，该函数以无符号<code>char</code> 强制转换为<code>int</code>的形式返回读取的字符，读成功，带回所读的字符，失败则返回文件结束标志<code>EOF</code>(-1)。</li></ul><h2 id="22-写字符fputc"><a class="markdownIt-Anchor" href="#22-写字符fputc"></a> 2.2 写字符fputc</h2><p>函数原型 <code>int fputc(int char, FILE *stream)</code>：</p><ul><li>调用形式<code>fputc(ch, fp)</code>；</li><li>把字符 <code>ch</code> 写到文件指针变量 <code>fp</code> 所指的文件中，输出成功返回值就是输出的字符，输出失败则返回<code>EOF</code>(-1)。</li></ul><h1 id="3-向文件读写字符串"><a class="markdownIt-Anchor" href="#3-向文件读写字符串"></a> 3 向文件读写字符串</h1><h2 id="31-读字符串fgets"><a class="markdownIt-Anchor" href="#31-读字符串fgets"></a> 3.1 读字符串fgets</h2><p>函数原型 <code>char *fgets(char *str, int n, FILE *stream)</code>：</p><ul><li>调用形式 <code>fgets(str, n, fp)</code>；</li><li><code>n</code> 为要求得到字符个数（但实际上只有 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>），从 <code>fp</code> 所指的文件读入一个长度为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> 的字符串，并在最后加一个<code>\0</code>；</li><li>然后把这 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span></span></span></span> 个字符存放在字符数组 <code>str</code> 中，若在读完 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> 个字符之前遇到换行符（<code>\n</code>）或文件结束符<code>EOF</code>，读入结束；</li><li>若执行函数成功，则返回 <code>str</code> 数组首元素的地址，若一开始就遇到文件末尾或读数据出错，则返回 <code>NULL</code>。</li></ul><h2 id="32-写字符串fputs"><a class="markdownIt-Anchor" href="#32-写字符串fputs"></a> 3.2 写字符串fputs</h2><p>函数原型 <code>int fputs(const char *str, FILE *stream)</code>：</p><ul><li>调用形式 <code>fputs(str, fp)</code>，把 <code>str</code> 所指向的字符串写到文件指针变量 <code>fp</code> 指向的文件中，字符串末尾的 <code>\0</code>不输出；</li><li>输出成功返回 <code>0</code>，失败返回 <code>EOF</code>。</li></ul><h1 id="4-格式化方式读写文件"><a class="markdownIt-Anchor" href="#4-格式化方式读写文件"></a> 4 格式化方式读写文件</h1><p><code>fprintf</code> 和 <code>fscanf</code>，在输入时要将文件的ASCII码转换为二进制形式在保存，再输出时又要将二进制形式转换为字符，要花费较多时间。</p><h2 id="41-格式化写fprintf"><a class="markdownIt-Anchor" href="#41-格式化写fprintf"></a> 4.1 格式化写fprintf</h2><p>函数原型 <code>int fprintf(FILE *stream, const char *format, ...)</code>：</p><ul><li>如果成功，则返回写入的字符总数，否则返回一个负数。</li></ul><h2 id="42-格式化读fscanf"><a class="markdownIt-Anchor" href="#42-格式化读fscanf"></a> 4.2 格式化读fscanf</h2><p>函数原型 <code>int fscanf(FILE *stream, const char *format, ...)</code>：</p><ul><li>如果成功，返回成功匹配和赋值的个数。如果到达文件末尾或发生读错误，则返回 <code>EOF</code>。</li></ul><h1 id="5-二进制向文件读写一组数据"><a class="markdownIt-Anchor" href="#5-二进制向文件读写一组数据"></a> 5 二进制向文件读写一组数据</h1><h2 id="51-二进制读fread"><a class="markdownIt-Anchor" href="#51-二进制读fread"></a> 5.1 二进制读fread</h2><p>函数原型 <code>size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream)</code>，</p><ul><li><code>ptr</code> 为从文件读入的数据保存的地址</li><li><code>size</code> 为要读的字节数</li><li><code>nmemb</code> 为元素的个数，每个元素的大小为 <code>size</code> 字节；</li><li><code>stream</code> 输出流的 <code>FILE</code> 指针；</li><li>返回成功读取的个数。</li></ul><h2 id="52-二进制写fwrite"><a class="markdownIt-Anchor" href="#52-二进制写fwrite"></a> 5.2 二进制写fwrite</h2><p>函数原型 <code>size_t fwrite(const void *ptr, size_t size, size_t nmemb, FILE *stream)</code>：</p><ul><li><code>ptr</code>为要向文件写入的数据首地址；</li><li><code>size</code>为要写的字节数；</li><li><code>nmemb</code>为元素的个数，每个元素的大小为 <code>size</code> 字节；</li><li><code>stream</code>输入流的<code>FILE</code>指针；</li><li>返回成功写入的个数。</li></ul><h1 id="6-随机读写数据文件"><a class="markdownIt-Anchor" href="#6-随机读写数据文件"></a> 6 随机读写数据文件</h1><h2 id="61-指向文件开头rewind"><a class="markdownIt-Anchor" href="#61-指向文件开头rewind"></a> 6.1 指向文件开头rewind</h2><p>函数原型 <code>void rewind(FILE *stream)</code>：</p><ul><li><code>rewind</code> 的作用是使文件位置标记重新返回文件的开头；</li><li>此函数没有返回值；</li><li>调用形式 <code>rewind(fp);</code>，将 <code>fp</code> 指向文件开头。</li></ul><h2 id="62-改变位置fseek"><a class="markdownIt-Anchor" href="#62-改变位置fseek"></a> 6.2 改变位置fseek</h2><p>函数原型 <code>int fseek(FILE *stream, long int offset, int whence)</code>：</p><ul><li><code>stream</code> 为所操作的文件指针；</li><li><code>offset</code> 这是相对 <code>whence</code> 的偏移量，以字节为单位，<strong>注意它是<code>long int</code>类型</strong>；</li><li><code>whence</code> 这是表示开始添加偏移 <code>offset</code> 的位置。它一般指定为下列常量之一：</li></ul><table><thead><tr><th>常量</th><th>描述</th><th>数字表示</th></tr></thead><tbody><tr><td>SEEK_SET</td><td>文件的开头</td><td>0</td></tr><tr><td>SEEK_CUR</td><td>文件指针的当前位置</td><td>1</td></tr><tr><td>SEEK_END</td><td>文件的末尾</td><td>2</td></tr></tbody></table><ul><li>向后移动，调用形式 <code>fseek(fp,100L,SEEK_SET);</code>，表示从文件的开头，向后偏移到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>100</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span></span></span></span> 个字节；</li><li>向前移动，调用形式 <code>fseek(fp,-200L,SEEK_END);</code>，表示从文件的末尾，向前偏移到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>200</mn></mrow><annotation encoding="application/x-tex">200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span></span></span></span> 个字节；</li><li>如果成功，则该函数返回零，否则返回非零值。</li></ul><h2 id="63-测定当前位置ftell"><a class="markdownIt-Anchor" href="#63-测定当前位置ftell"></a> 6.3 测定当前位置ftell</h2><p>函数原型 <code>long int ftell(FILE *stream)</code>：</p><ul><li><code>stream</code> 文件指针；</li><li><code>ftell</code> 函数的作用是得到流式文件中文件位置标记的当前位置；</li><li>该函数返回位置标识符的当前值。如果发生错误，则返回 <code>-1L</code>，全局变量 <code>errno</code> 被设置为一个正值。</li></ul><h1 id="7-文件读写出错检测"><a class="markdownIt-Anchor" href="#7-文件读写出错检测"></a> 7 文件读写出错检测</h1><h2 id="71-函数ferror"><a class="markdownIt-Anchor" href="#71-函数ferror"></a> 7.1 函数ferror</h2><ul><li>在调用一个输入输出函数后，可以使用 <code>ferror(fp)</code> 检测是否出现错误；</li><li>返回 <code>0</code> 代表未出错，返回非零表示出错；</li><li>对同一个文件每调用一次输入输出函数，都会产生新的值，应该在每次输入输出函数调用后，立即检测。</li></ul><h2 id="72-函数clearerr"><a class="markdownIt-Anchor" href="#72-函数clearerr"></a> 7.2 函数clearerr</h2><ul><li>若调用一个输入输出函数出错后，<code>ferror</code> 为非零值；</li><li>调用 <code>clearerr(fp);</code>可以将错误标记的值置位 <code>0</code>，以便一下次检测。</li></ul></div><div class="prev-or-next"><div class="post-foot-next"><a href="/2018/02/22/%E5%AF%BC%E5%85%A5css%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/" target="_self"><i class="iconfont icon-chevronleft"></i> <span>上一页</span></a></div><div class="post-attach"><span class="post-pubtime"><i class="iconfont icon-updatetime" title="更新时间"></i> 2019-12-13 19:36:40 </span><span class="post-tags"><i class="iconfont icon-tags" title="标签"></i> <span class="span--tag"><a href="/tags/C%E8%AF%AD%E8%A8%80/" title="C语言"><b>#</b> C语言</a></span></span></div><div class="post-foot-prev"><a href="/2019/12/13/%E5%8F%98%E9%87%8F%E7%94%9F%E5%AD%98%E6%9C%9F%E5%8F%8A%E4%BD%9C%E7%94%A8%E5%9F%9F/" target="_self"><span>下一页</span> <i class="iconfont icon-chevronright"></i></a></div></div></div><div id="btn-catalog" class="btn-catalog"><i class="iconfont icon-catalog"></i></div><div class="post-catalog hidden" id="catalog"><div class="title">目录</div><div class="catalog-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-fopen%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="toc-text">1 fopen文件操作方式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6fopen"><span class="toc-text">1.1 打开文件fopen</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E5%85%B3%E9%97%AD%E6%96%87%E4%BB%B6fclose"><span class="toc-text">1.2 关闭文件fclose</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%90%91%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99%E5%AD%97%E7%AC%A6"><span class="toc-text">2 向文件读写字符</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#21-%E8%AF%BB%E5%AD%97%E7%AC%A6fgetc"><span class="toc-text">2.1 读字符fgetc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-%E5%86%99%E5%AD%97%E7%AC%A6fputc"><span class="toc-text">2.2 写字符fputc</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%90%91%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-text">3 向文件读写字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#31-%E8%AF%BB%E5%AD%97%E7%AC%A6%E4%B8%B2fgets"><span class="toc-text">3.1 读字符串fgets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-%E5%86%99%E5%AD%97%E7%AC%A6%E4%B8%B2fputs"><span class="toc-text">3.2 写字符串fputs</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%96%B9%E5%BC%8F%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-text">4 格式化方式读写文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#41-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%86%99fprintf"><span class="toc-text">4.1 格式化写fprintf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#42-%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%AF%BBfscanf"><span class="toc-text">4.2 格式化读fscanf</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%90%91%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99%E4%B8%80%E7%BB%84%E6%95%B0%E6%8D%AE"><span class="toc-text">5 二进制向文件读写一组数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#51-%E4%BA%8C%E8%BF%9B%E5%88%B6%E8%AF%BBfread"><span class="toc-text">5.1 二进制读fread</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#52-%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%86%99fwrite"><span class="toc-text">5.2 二进制写fwrite</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E9%9A%8F%E6%9C%BA%E8%AF%BB%E5%86%99%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6"><span class="toc-text">6 随机读写数据文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#61-%E6%8C%87%E5%90%91%E6%96%87%E4%BB%B6%E5%BC%80%E5%A4%B4rewind"><span class="toc-text">6.1 指向文件开头rewind</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#62-%E6%94%B9%E5%8F%98%E4%BD%8D%E7%BD%AEfseek"><span class="toc-text">6.2 改变位置fseek</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#63-%E6%B5%8B%E5%AE%9A%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AEftell"><span class="toc-text">6.3 测定当前位置ftell</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99%E5%87%BA%E9%94%99%E6%A3%80%E6%B5%8B"><span class="toc-text">7 文件读写出错检测</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#71-%E5%87%BD%E6%95%B0ferror"><span class="toc-text">7.1 函数ferror</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#72-%E5%87%BD%E6%95%B0clearerr"><span class="toc-text">7.2 函数clearerr</span></a></li></ol></li></ol></div></div><script src="/js/catalog.js"></script><div class="comments-container"></div></div><div class="footer"><div class="social"><ul><li><a title="github" target="_blank" rel="noopener" href="https://github.com/syzdev"><i class="iconfont icon-github"></i></a></li></ul></div><div class="footer-more"><a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Theme by Oranges | Powered by Hexo</a></div></div></div><div class="tools-bar"><div class="back-to-top tools-bar-item hidden"><a href="javascript: void(0)"><i class="iconfont icon-chevronup"></i></a></div><script src="/js/backtotop.js"></script><div class="search-icon tools-bar-item" id="search-icon"><a href="javascript: void(0)"><i class="iconfont icon-search"></i></a></div><div class="search-overlay hidden"><div class="search-content" tabindex="0"><div class="search-title"><span class="search-icon-input"><a href="javascript: void(0)"><i class="iconfont icon-search"></i> </a></span><input type="text" class="search-input" id="search-input" placeholder="搜索..."> <span class="search-close-icon" id="search-close-icon"><a href="javascript: void(0)"><i class="iconfont icon-close"></i></a></span></div><div class="search-result" id="search-result"></div></div></div><script type="text/javascript">var inputArea=document.querySelector("#search-input"),searchOverlayArea=document.querySelector(".search-overlay");function openOrHideSearchContent(){searchOverlayArea.classList.contains("hidden")?(searchOverlayArea.classList.remove("hidden"),document.body.classList.add("hidden")):(searchOverlayArea.classList.add("hidden"),document.body.classList.remove("hidden"))}function blurSearchContent(e){e.target===searchOverlayArea&&openOrHideSearchContent()}inputArea.onclick=function(){getSearchFile(),this.onclick=null},inputArea.onkeydown=function(){if(13==event.keyCode)return!1},document.querySelector("#search-icon").addEventListener("click",openOrHideSearchContent,!1),document.querySelector("#search-close-icon").addEventListener("click",openOrHideSearchContent,!1),searchOverlayArea.addEventListener("click",blurSearchContent,!1);var searchFunc=function(e,t,n){"use strict";var r=document.getElementById(t),a=document.getElementById(n);a.innerHTML="<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>",$.ajax({url:e,dataType:"xml",success:function(e){var t=$("entry",e).map((function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}})).get();a.innerHTML="",r.addEventListener("input",(function(){var e='<ul class="search-result-list">',n=this.value.trim().toLowerCase().split(/[\s\-]+/);if(a.innerHTML="",!(this.value.trim().length<=0)){if(t.forEach((function(t){var r=!0;t.title&&""!==t.title.trim()||(t.title="Untitled");var a=t.title.trim(),c=a.toLowerCase(),s=t.content.trim().replace(/<[^>]+>/g,""),i=s.toLowerCase(),l=t.url,o=-1,u=-1,h=-1;if(""!==i?n.forEach((function(e,t){o=c.indexOf(e),u=i.indexOf(e),o<0&&u<0?r=!1:(u<0&&(u=0),0==t&&(h=u))})):r=!1,r){e+="<li><a href='"+l+"' class='search-result-title'>"+a+"</a>";var d=s;if(h>=0){var p=h-20,f=h+80;p<0&&(p=0),0==p&&(f=100),f>d.length&&(f=d.length);var m=d.substr(p,f);n.forEach((function(e){var t=new RegExp(e,"gi");m=m.replace(t,'<span class="search-keyword">'+e+"</span>")})),e+='<p class="search-result-abstract">'+m+"...</p>"}e+="</li>"}})),-1===(e+="</ul>").indexOf("<li>"))return a.innerHTML="<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>";a.innerHTML=e}}))},error:function(e,t,n){a.innerHTML="",404===e.status?a.innerHTML="<ul><span class='local-search-empty'>未找到search.xml文件，具体请参考：<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>":a.innerHTML="<ul><span class='local-search-empty'>请求失败，尝试重新刷新页面或稍后重试。<span></ul>"}}),$(document).on("click","#search-close-icon",(function(){$("#search-input").val(""),$("#search-result").html("")}))},getSearchFile=function(){searchFunc("/search.xml","search-input","search-result")}</script><div class="tools-bar-item theme-icon" id="switch-color-scheme"><a href="javascript: void(0)"><i id="theme-icon" class="iconfont icon-moon"></i></a></div><script src="/js/colorscheme.js"></script></div></div></body></html>