<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;light&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn.u1.huluxia.com/g3/M03/4D/84/wKgBOV6fGZWATbp6AAAML1Rr8NY150.png"><link rel="icon" href="https://cdn.u1.huluxia.com/g3/M03/4D/84/wKgBOV6fGZWATbp6AAAML1Rr8NY150.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content=""><meta name="author" content="syz"><meta name="keywords" content=""><title>è·¨åŸŸçš„åŸç†å’Œå¤„ç†è·¨åŸŸçš„å¸¸ç”¨æ–¹æ³• - syzdev</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.6.0/styles/atom-one-dark.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"yoursite.com",root:"/",version:"1.8.10",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:1},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null}}}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><header style="height:35vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>ğŸ˜„ syzdev</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> é¦–é¡µ</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> å½’æ¡£</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> åˆ†ç±»</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> å…³äº</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(https://cdn.u1.huluxia.com/g3/M02/4D/6C/wKgBOV6fEU2AXFGSAAJ7A1Fp7rw147.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="è·¨åŸŸçš„åŸç†å’Œå¤„ç†è·¨åŸŸçš„å¸¸ç”¨æ–¹æ³•"></span><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-04-24 16:15" pubdate>2022å¹´4æœˆ24æ—¥ ä¸‹åˆ</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 2.8k å­— </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 35 åˆ†é’Ÿ</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">è·¨åŸŸçš„åŸç†å’Œå¤„ç†è·¨åŸŸçš„å¸¸ç”¨æ–¹æ³•</h1><div class="markdown-body"><h1 id="1-æµè§ˆå™¨åŒæºç­–ç•¥"><a class="markdownIt-Anchor" href="#1-æµè§ˆå™¨åŒæºç­–ç•¥"></a> 1 æµè§ˆå™¨åŒæºç­–ç•¥</h1><h2 id="11-åŒæºç­–ç•¥ç®€ä»‹"><a class="markdownIt-Anchor" href="#11-åŒæºç­–ç•¥ç®€ä»‹"></a> 1.1 åŒæºç­–ç•¥ç®€ä»‹</h2><p>åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„ä¸€ä¸ªé‡è¦çš„å®‰å…¨ç­–ç•¥ï¼Œå®ƒç”¨äºé™åˆ¶ä¸€ä¸ªæºä¸å¦å¤–ä¸€ä¸ªæºä¹‹é—´çš„äº¤äº’ï¼Œå®ƒèƒ½å¸®åŠ©é˜»éš”æ¶æ„è„šæœ¬ï¼Œå‡å°‘éšç§æ³„éœ²å’Œç½‘ç»œæ”»å‡»ç­‰é£é™©ã€‚</p><h2 id="12-æºorigin"><a class="markdownIt-Anchor" href="#12-æºorigin"></a> 1.2 æºï¼ˆ<code>Origin</code>ï¼‰</h2><p>é€šå¸¸æŠŠè®¿é—®Webä¸­å†…å®¹çš„åœ°å€å°±å«æºï¼ˆ<code>Origin</code>ï¼‰ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯è®¿é—®ä¸€ä¸ªå†…å®¹çš„URLï¼Œåœ¨URLä¸­å¿…é¡»æŒ‡æ˜åè®®ã€ä¸»æœºåŸŸåå’Œç«¯å£ã€‚</p><p>ä¸€ä¸ªURLå¯èƒ½åŒ…å«åè®®ã€ä¸»æœºåŸŸåã€ç«¯å£ã€ç›®å½•ã€æ–‡ä»¶åã€æŸ¥è¯¢å‚æ•°å’Œé”šç‚¹è¿™äº›éƒ¨åˆ†ï¼Œä»¥ä¸‹é¢URLä¸ºä¾‹ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>syzdev.cn:<span class="hljs-number">443</span><span class="hljs-regexp">/news/i</span>ndex.html?category=<span class="hljs-number">1</span>&amp;page=<span class="hljs-number">2</span><span class="hljs-comment">#top</span><br></code></pre></div></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2d0effe9dc5e4ef7af34828e9bbec369.png#pic_center" srcset="/img/loading.gif" lazyload alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>åè®®ï¼šç½‘ç»œåº”ç”¨å±‚åè®®ï¼Œå¸¸è§çš„æœ‰HTTPã€HTTPSå’ŒFTPåè®®ï¼›</li><li>ä¸»æœºåŸŸåï¼šå¯ä»¥æ˜¯ä¸»æœºIPåœ°å€æˆ–åŸŸåï¼›</li><li>ç«¯å£ï¼šå¯ä»¥æŒ‡å®šå…·ä½“çš„ç«¯å£ï¼Œè‹¥ä¸æŒ‡å®šç«¯å£åˆ™ä¸ºé»˜è®¤å€¼ï¼Œå¦‚HTTPåè®®çš„é»˜è®¤ç«¯å£ä¸º80ç«¯å£ï¼ŒHTTPSåè®®çš„é»˜è®¤ç«¯å£ä¸º443ç«¯å£ï¼›</li><li>ç›®å½•ï¼šç›®æ ‡æ–‡ä»¶çš„ç›®å½•ï¼›</li><li>æ–‡ä»¶åï¼šç›®æ ‡æ–‡ä»¶çš„æ–‡ä»¶åï¼›</li><li>æŸ¥è¯¢å‚æ•°ï¼šä»¥â€œ<code>?</code>â€åˆ†éš”åœ¨URLåè¿½åŠ å‚æ•°ï¼Œç”¨é”®å€¼å¯¹ï¼ˆ<code>key=value</code>ï¼‰çš„å½¢å¼è¡¨ç¤ºå‚æ•°å€¼ï¼Œè‹¥æœ‰å¤šä¸ªå‚æ•°ï¼Œåˆ™é”®å€¼å¯¹ä¹‹é—´ä»¥â€œ<code>&amp;</code>â€åˆ†éš”ï¼›</li><li>é”šç‚¹ï¼šç”¨äºå®šä½åˆ°é¡µé¢ä¸­çš„å…·ä½“ä½ç½®ï¼Œè‹¥å®šä½åˆ°é¡µé¢ä¸­æ–‡ç« çš„æŸä¸ªæ ‡é¢˜ã€‚</li></ul><h2 id="13-åŒæº"><a class="markdownIt-Anchor" href="#13-åŒæº"></a> 1.3 åŒæº</h2><p>å¦‚æœä¸¤ä¸ªæºçš„åè®®ã€ä¸»æœºåŸŸåå’Œç«¯å£éƒ½ç›¸åŒçš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæºå°±ç§°ä¸ºåŒæºï¼Œä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼š</p><ol><li>ç›®å½•å’Œæ–‡ä»¶å<br><img src="https://img-blog.csdnimg.cn/346ef7d555ef475496539ff98c8105c9.png" srcset="/img/loading.gif" lazyload alt=""></li><li>åè®®<br><img src="https://img-blog.csdnimg.cn/12486797e429493389dcf85bbecd3377.png" srcset="/img/loading.gif" lazyload alt=""></li><li>ä¸»æœºåŸŸå<br><img src="https://img-blog.csdnimg.cn/49163f69a36e466ea6d7f2d6e16eeffa.png" srcset="/img/loading.gif" lazyload alt=""></li><li>ç«¯å£<br><img src="https://img-blog.csdnimg.cn/5a702088e05a4af192d3c7b10571db0b.png" srcset="/img/loading.gif" lazyload alt=""></li></ol><h2 id="14-åŒæºç­–ç•¥çš„é™åˆ¶"><a class="markdownIt-Anchor" href="#14-åŒæºç­–ç•¥çš„é™åˆ¶"></a> 1.4 åŒæºç­–ç•¥çš„é™åˆ¶</h2><p>é¦–å…ˆè¦æ˜ç¡®ä¸€ç‚¹ï¼ŒåŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„ä¸€ç§æœºåˆ¶ï¼ŒåŒæºç­–ç•¥æ‰€äº§ç”Ÿçš„è¡Œä¸ºéƒ½æ˜¯æ¥è‡ªäºæµè§ˆå™¨ã€‚åŒæºç­–ç•¥æœ‰å¦‚ä¸‹é™åˆ¶ï¼š</p><ul><li>æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼š<code>localStorage</code>ã€<code>sessionStorage</code>å’Œ<code>IndexedDB</code>çš„ä½œç”¨èŒƒå›´éƒ½æ˜¯å—åŒæºç­–ç•¥çš„é™åˆ¶ï¼›</li><li>è·¨æºè„šæœ¬è®¿é—®ï¼šå…¶ä»–æºçš„è„šæœ¬æ— æ³•æ“ä½œæœ¬æºä¸­çš„æ–‡æ¡£ï¼›</li><li>è·¨æºç½‘ç»œè¯·æ±‚ï¼šåŒæºç­–ç•¥é™åˆ¶äº†ä¸åŒæºä¹‹é—´çš„ç½‘ç»œè¯·æ±‚äº¤äº’ã€‚</li></ul><p>å…¶ä¸­è·¨æºç½‘ç»œè¯·æ±‚å°±æ˜¯æœ¬æ–‡è®¨è®ºçš„é‡ç‚¹ï¼Œé™åˆ¶è·¨æºç½‘ç»œè¯·æ±‚æœ¬æ„æ˜¯ä¸ºäº†æµè§ˆå™¨å®‰å…¨ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­ï¼Œç½‘ç»œè¯·æ±‚å’Œè¯·æ±‚ä¸»æœºå¾€å¾€éƒ½æ˜¯åœ¨ä¸åŒçš„æºçš„ï¼Œæ­¤æ—¶å°±éœ€è¦è·¨æºè®¿é—®ï¼Œæ‰€ç”¨çš„æŠ€æœ¯å°±æ˜¯â€œè·¨åŸŸâ€ã€‚</p><h1 id="2-è·¨åŸŸçš„æ–¹æ³•"><a class="markdownIt-Anchor" href="#2-è·¨åŸŸçš„æ–¹æ³•"></a> 2 è·¨åŸŸçš„æ–¹æ³•</h1><p>å½“è¯·æ±‚å‘ç”Ÿè·¨åŸŸæ—¶ï¼Œè‹¥æ²¡æœ‰å¤„ç†è·¨åŸŸï¼Œåˆ™ä¼šåœ¨æ§åˆ¶å°çœ‹åˆ°å¦‚ä¸‹é”™è¯¯ï¼š<br><br><img src="https://img-blog.csdnimg.cn/62379952448b4b449992e0d1999b3ed1.png#pic_center" srcset="/img/loading.gif" lazyload alt=""></p><p><br>ä¸‹é¢åˆ—å‡ºçš„å››ç§å¤„ç†è·¨åŸŸæ–¹æ³•çš„å®Œæ•´ä»£ç éƒ½å·²ä¸Šä¼ è‡³GitHubä»“åº“ï¼š<a target="_blank" rel="noopener" href="https://github.com/syzdev/cors-demo">cors-demo</a>ã€‚</p><h2 id="21-cors"><a class="markdownIt-Anchor" href="#21-cors"></a> 2.1 CORS</h2><p>è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼ŒCross-Origin Resource Sharingï¼‰å…è®¸Webåº”ç”¨æœåŠ¡å™¨è¿›è¡Œè·¨æºè®¿é—®æ§åˆ¶ï¼Œä»è€Œä½¿è·¨æºæ•°æ®ä¼ è¾“å¾—ä»¥å®‰å…¨è¿›è¡Œã€‚</p><p>è·¨æºèµ„æºå…±äº«æ ‡å‡†æ–°å¢äº†ä¸€ç»„HTTPé¦–éƒ¨å­—æ®µï¼Œå…è®¸æœåŠ¡å™¨å£°æ˜å“ªäº›æºç«™é€šè¿‡æµè§ˆå™¨æœ‰æƒé™è®¿é—®å“ªäº›èµ„æºã€‚å¦å¤–ï¼Œè§„èŒƒè¦æ±‚ï¼Œå¯¹é‚£äº›å¯èƒ½å¯¹æœåŠ¡å™¨æ•°æ®äº§ç”Ÿå‰¯ä½œç”¨çš„HTTPè¯·æ±‚æ–¹æ³•ï¼ˆç‰¹åˆ«æ˜¯GETä»¥å¤–çš„HTTPè¯·æ±‚ï¼Œæˆ–è€…æ­é…æŸäº›MIMEç±»å‹çš„POSTè¯·æ±‚ï¼‰ï¼Œæµè§ˆå™¨å¿…é¡»é¦–å…ˆä½¿ç”¨OPTIONSæ–¹æ³•å‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚ï¼ˆpreflight requestï¼‰ï¼Œä»è€Œè·çŸ¥æœåŠ¡ç«¯æ˜¯å¦å…è®¸è¯¥è·¨æºè¯·æ±‚ã€‚æœåŠ¡å™¨ç¡®è®¤å…è®¸ä¹‹åï¼Œæ‰å‘èµ·å®é™…çš„HTTPè¯·æ±‚ã€‚åœ¨é¢„æ£€è¯·æ±‚çš„è¿”å›ä¸­ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿå¯ä»¥é€šçŸ¥å®¢æˆ·ç«¯ï¼Œæ˜¯å¦éœ€è¦æºå¸¦èº«ä»½å‡­è¯ï¼ˆåŒ…æ‹¬Cookieså’ŒHTTPè®¤è¯ç›¸å…³æ•°æ®ï¼‰ã€‚</p><p>åœ¨CORSæœºåˆ¶ä¸‹ï¼Œæµè§ˆå™¨HTTPè¯·æ±‚è¢«åˆ†ä¸ºäº†ç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚ä¸¤ç§ï¼Œå…¶ä¸­ç®€å•è¯·æ±‚å°†ç›´æ¥å‘é€è¯·æ±‚ï¼Œè€Œéç®€å•è¯·æ±‚ä¼šå…ˆå‘é€ä¸€ä¸ªé¢„æ£€è¯·æ±‚ï¼Œå½“æœåŠ¡å™¨ç¡®è®¤ä¹‹åæ‰èƒ½å‘å‡ºHTTPè¯·æ±‚ã€‚</p><p>æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„è¯·æ±‚ç§°ä¸ºç®€å•è¯·æ±‚ï¼Œé™¤æ­¤ä¹‹å¤–éƒ½æ˜¯éç®€å•è¯·æ±‚ï¼š</p><ul><li>è¯·æ±‚æ–¹æ³•ä¸º<code>GET</code>ã€<code>HEAD</code>å’Œ<code>POST</code>ï¼›</li><li>è¯·æ±‚å¤´ä¸­åªèƒ½åŒ…å«<code>Accept</code>ã€<code>Accept-Language</code>ã€<code>Content-Language</code>å’Œ<code>Content-Type</code>ï¼Œä¸”<code>Content-Type</code>çš„å€¼åªèƒ½ä¸º<code>text/plain</code>ã€<code>multipart/form-data</code>å’Œ<code>application/x-www-form-urlencoded</code>ï¼›</li></ul><h3 id="211-ç®€å•è¯·æ±‚çš„å‘é€è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#211-ç®€å•è¯·æ±‚çš„å‘é€è¿‡ç¨‹"></a> 2.1.1 ç®€å•è¯·æ±‚çš„å‘é€è¿‡ç¨‹</h3><p>ä»¥ä¸‹é¢é€šè¿‡<code>XMLHttpRequest</code>å‘é€ç®€å•è¯·æ±‚ä¸ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">send</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest()<br>  xhr.open(<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;https://syzdev.cn/news&#x27;</span>)<br>  xhr.send()<br>&#125;<br></code></pre></div></td></tr></table></figure><ol><li>å®¢æˆ·ç«¯å‘é€HTTPç®€å•è¯·æ±‚ï¼Œè¯·æ±‚å¤´ä¸­åŒ…å«è¯·æ±‚ç±»å‹ã€è¯·æ±‚æºå’Œè¯·æ±‚æœåŠ¡å™¨ç­‰å­—æ®µã€‚</li></ol><p><img src="https://img-blog.csdnimg.cn/7555840ff84b45e99b9f05429519b01e.png" srcset="/img/loading.gif" lazyload alt=""></p><ol start="2"><li>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œä¼šæ ¹æ®è¯·æ±‚å¤´çš„<code>Origin</code>å­—æ®µåˆ¤æ–­è¿™ä¸ªè¯·æ±‚æ¥è‡ªäºå“ªä¸ªæºï¼Œè‹¥è¿™ä¸ªæºä¸åœ¨è®¿é—®æœåŠ¡å™¨èµ„æºçš„è®¸å¯èŒƒå›´å†…ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼›è‹¥è¿™ä¸ªæºåœ¨èŒƒå›´ä¹‹å†…ï¼Œåˆ™æœåŠ¡å™¨ä¼šåœ¨å“åº”å¤´ä¸­æ·»åŠ <code>Access-Control-Allow-Origin</code>å­—æ®µï¼Œå­—æ®µçš„å€¼å¯èƒ½æ˜¯<code>Origin</code>çš„å€¼<code>https://syzdev.cn</code>ï¼Œæˆ–è€…æ˜¯é€šé…ç¬¦<code>*</code>ï¼Œè¡¨ç¤ºæ‰€æœ‰çš„æºéƒ½å…è®¸ã€‚</li></ol><p><img src="https://img-blog.csdnimg.cn/7c907cecdd594aa3a241426ee58a9c1a.png" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="212-éç®€å•è¯·æ±‚çš„å‘é€è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#212-éç®€å•è¯·æ±‚çš„å‘é€è¿‡ç¨‹"></a> 2.1.2 éç®€å•è¯·æ±‚çš„å‘é€è¿‡ç¨‹</h3><p>ä»¥ä¸‹é¢é€šè¿‡<code>XMLHttpRequest</code>å‘é€ç®€å•è¯·æ±‚ä¸ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">send</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest()<br>  xhr.open(<span class="hljs-string">&#x27;DELETE&#x27;</span>, <span class="hljs-string">&#x27;https://syzdev.cn/others&#x27;</span>)<br>  xhr.send()<br>&#125;<br></code></pre></div></td></tr></table></figure><ol><li>å®¢æˆ·ç«¯å‘é€HTTPéç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨åœ¨æ­£å¼å‘é€è¯·æ±‚ä¹‹å‰ï¼Œä¼šä½¿ç”¨OPTIONSæ–¹æ³•å‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚ï¼ˆpreflight requestï¼‰ï¼Œä»è€Œè·çŸ¥æœåŠ¡ç«¯æ˜¯å¦å…è®¸è¯¥è·¨æºè¯·æ±‚ã€‚</li></ol><p><img src="https://img-blog.csdnimg.cn/0b1f28122a574d78903b984f5a5a0a41.png" srcset="/img/loading.gif" lazyload alt=""></p><ol start="2"><li>å®¢æˆ·ç«¯æ”¶åˆ°è¯·æ±‚åï¼Œæ£€æŸ¥<code>Origin</code>ã€<code>Access-Control-Request-Method</code>å’Œ<code>Access-Control-Request-Headers</code>å­—æ®µä»¥åï¼Œåˆ¤æ–­è¯·æ±‚çš„æºå’Œæ–¹æ³•ç±»å‹æ˜¯å¦åœ¨å…è®¸èŒƒå›´å†…ï¼Œè‹¥ä¸åœ¨å…è®¸èŒƒå›´å†…ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼›è‹¥åœ¨å…è®¸çš„èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨åˆ™è¿”å›ä¸€ä¸ªç¡®è®¤çš„å“åº”ã€‚</li></ol><p><img src="https://img-blog.csdnimg.cn/e077fb28a80d408e8fb0ca5b4fb2f911.png" srcset="/img/loading.gif" lazyload alt=""></p><ol start="3"><li>ä¸€æ—¦å®¢æˆ·ç«¯é€šè¿‡äº†é¢„æ£€è¯·æ±‚ï¼Œåˆ™åç»­çš„äº¤äº’éƒ½å’Œç®€å•è¯·æ±‚ä¸€æ ·ã€‚</li></ol><h3 id="223-corsçš„ä½¿ç”¨æ–¹æ³•"><a class="markdownIt-Anchor" href="#223-corsçš„ä½¿ç”¨æ–¹æ³•"></a> 2.2.3 CORSçš„ä½¿ç”¨æ–¹æ³•</h3><p>ä»¥<code>express</code>ä¸ºä¾‹ï¼Œä½¿ç”¨CORSæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡<code>response.setHeader</code>è®¾ç½®å“åº”å¤´ï¼Œä¸€ç§æ˜¯é€šè¿‡ä¸­é—´ä»¶<code>cors</code>ã€‚å‘é€è¯·æ±‚çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">send</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest()<br>  xhr.open(<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;http://localhost:3000/&#x27;</span>)<br>  xhr.send()<br>  xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-comment">// xhr.readyState === 4è¡¨ç¤ºå“åº”å·²å®Œæˆï¼Œæ­¤æ—¶å¯ä»¥è·å–å¹¶ä½¿ç”¨æœåŠ¡å™¨çš„å“åº”ã€‚</span><br>    <span class="hljs-keyword">if</span> (xhr.readyState === <span class="hljs-number">4</span>) &#123;<br>      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;main&#x27;</span>).innerHTML = xhr.response<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¤„ç†è·¨åŸŸçš„ä¸¤ç§æ–¹å¼åˆ†åˆ«å¦‚ä¸‹ï¼š</p><ol><li>è®¾ç½®å“åº”å¤´</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = express()<br>app.get(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// è®¾ç½®å“åº”å¤´ï¼Œå…è®¸è·¨åŸŸ</span><br>  response.setHeader(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>)<br>  <span class="hljs-comment">// è®¾ç½®å“åº”ä½“</span><br>  response.send(<span class="hljs-string">&#x27;setHeader&#x27;</span>)<br>&#125;)<br>app.listen(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;æœåŠ¡å·²å¯åŠ¨ï¼Œç›‘å¬3000ç«¯å£&#x27;</span>)<br>&#125;)<br></code></pre></div></td></tr></table></figure><ol start="2"><li><code>cors</code>ä¸­é—´ä»¶</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = express()<br><br><span class="hljs-comment">// å¼•å…¥corsï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç›´æ¥()æ‰§è¡Œï¼Œæ‰§è¡Œåæ˜¯ä¸€ä¸ªExpressä¸­é—´ä»¶ï¼Œapp.useä½¿ç”¨å®ƒå³å¯</span><br>app.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;cors&#x27;</span>)())<br><br>app.get(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// send()æ–¹æ³•ï¼Œå“åº”ç»™å®¢æˆ·ç«¯ä¿¡æ¯</span><br>  res.send(<span class="hljs-string">&#x27;cors_middleware&#x27;</span>)<br>&#125;)<br><br>app.listen(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;ç½‘ç«™æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼&#x27;</span>)<br>&#125;)<br></code></pre></div></td></tr></table></figure><h2 id="22-jsonp"><a class="markdownIt-Anchor" href="#22-jsonp"></a> 2.2 JSONP</h2><p>JSONPä¸»è¦å°±æ˜¯åˆ©ç”¨äº†<code>&lt;script&gt;</code>æ ‡ç­¾æ²¡æœ‰è·¨åŸŸé™åˆ¶çš„è¿™ä¸ªç‰¹æ€§æ¥å®Œæˆçš„ï¼Œä½¿ç”¨JSONPè¿›è¡Œè·¨åŸŸåªæ”¯æŒ<code>GET</code>è¯·æ±‚ã€‚åœ¨JSONPä¸­æ˜¯ä½¿ç”¨<code>&lt;script&gt;</code>æ ‡ç­¾çš„<code>src</code>å±æ€§å‘é€è¯·æ±‚çš„ï¼Œå¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://localhost:3000/&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>æ­¤æ—¶åªèƒ½å‘é€è¯·æ±‚ï¼Œå¹¶æ²¡æœ‰å“åº”è¯·æ±‚çš„èƒ½åŠ›ï¼Œæ‰€ä»¥éœ€è¦ç»™è¯·æ±‚æ·»åŠ ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ä½œä¸º<code>query</code>å‚æ•°å‘é€ç»™æœåŠ¡ç«¯ï¼Œç”±æœåŠ¡ç«¯å†è¿”å›è¿™ä¸ªå‚æ•°å¹¶ç”±æµè§ˆå™¨è§£æï¼š</p><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;main&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><span class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jsonpCallback</span>(<span class="hljs-params">res</span>) </span>&#123;</span><br><span class="javascript">      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;main&#x27;</span>).innerHTML = res.data</span><br>    &#125;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://localhost:3000/?callback=jsonpCallback&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>åç«¯ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">let</span> app = express()<br>app.get(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">let</span> callback = request.query.callback<br>  <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">JSON</span>.stringify(&#123;<br>    data: <span class="hljs-string">&#x27;JSONP&#x27;</span><br>  &#125;)<br>  response.send(callback + <span class="hljs-string">`(<span class="hljs-subst">$&#123;data&#125;</span>)`</span>)<br>&#125;)<br>app.listen(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;æœåŠ¡å·²å¯åŠ¨ï¼Œç›‘å¬3000ç«¯å£&#x27;</span>)<br>&#125;)<br></code></pre></div></td></tr></table></figure><p>åœ¨åç«¯é€šè¿‡<code>request.query.callback</code>è·å–åˆ°å‰ç«¯ä¼ å…¥çš„è¯·æ±‚å›è°ƒæ–¹æ³•<code>jsonpCallback</code>ï¼Œåœ¨åç«¯é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥<code>callback +</code>(${data})``ï¼ŒæŠŠåç«¯æ•°æ®<code>data</code>é€šè¿‡å‡½æ•°å‚æ•°çš„å½¢å¼è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°å‚æ•°åè§£ææˆå‡½æ•°è°ƒç”¨<code>jsonpCallback(res)</code>ï¼Œåœ¨å®¢æˆ·ç«¯æ‰§è¡Œäº†å›è°ƒå¹¶ä¸”æ”¶åˆ°äº†åç«¯ä¼ å…¥çš„æ•°æ®<code>data</code>ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼ŒJSONPå°±æ˜¯åˆ©ç”¨äº†<code>&lt;script&gt;</code>æ ‡ç­¾å¯ä»¥è·¨åŸŸå‘é€è¯·æ±‚è¿™ä¸€ç‰¹ç‚¹ï¼Œå®¢æˆ·ç«¯å°†æ–¹æ³•ä½œä¸ºè¯·æ±‚çš„å‚æ•°å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†åç«¯æ•°æ®ä½œä¸ºæ–¹æ³•çš„å‚æ•°è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæœ€åå®¢æˆ·ç«¯å°†è¿”å›çš„ä¿¡æ¯è§£ææˆå‡½æ•°è°ƒç”¨ï¼Œè¿™æ ·å°±å®ç°äº†è·¨åŸŸè¯·æ±‚äº¤äº’ã€‚</p><h2 id="23-vue-cli"><a class="markdownIt-Anchor" href="#23-vue-cli"></a> 2.3 Vue CLI</h2><p>ä½¿ç”¨Vue CLIå¤„ç†è·¨åŸŸåªèƒ½åœ¨å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œä¸‹æ–‡ä¸­ç¤ºä¾‹ä»£ç çš„åˆ›å»ºç¯å¢ƒå¦‚ä¸‹ï¼š</p><ul><li>Vue CLIç‰ˆæœ¬ï¼š@vue/cli 5.0.4</li><li>Vueç‰ˆæœ¬ï¼š2.x</li></ul><p>ä½¿ç”¨Vue CLIåˆ›å»ºä¸€ä¸ªVue2.xçš„é¡¹ç›®ï¼Œè¾“å…¥å‘½ä»¤<code>npm i axios</code>æ·»åŠ <code>axios</code>ï¼Œæ–°å»º<code>http.js</code>å°è£…<code>axios</code>å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><br><span class="hljs-keyword">const</span> http = axios.create(&#123;<br>  baseURL: <span class="hljs-string">&#x27;/api&#x27;</span><br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> http<br></code></pre></div></td></tr></table></figure><p>åœ¨<code>App.vue</code>ä¸­æ·»åŠ è¯·æ±‚çš„æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vue">&lt;template&gt;<br>&lt;div id&#x3D;&quot;app&quot;&gt;<br>  &#123;&#123; msg &#125;&#125;<br>  &lt;&#x2F;div&gt;<br>&lt;&#x2F;template&gt;<br><br>&lt;script&gt;<br>  import http from &#39;.&#x2F;http&#39;<br>  export default &#123;<br>    name: &#39;App&#39;,<br>    data() &#123;<br>      return &#123;<br>        msg: &#39;default msg&#39;,<br>      &#125;<br>    &#125;,<br>    created() &#123;<br>      this.fetchData()<br>    &#125;,<br>    methods: &#123;<br>      async fetchData() &#123;<br>        const res &#x3D; await http.get(&#39;&#x2F;msg&#39;)<br>        this.msg &#x3D; res.data<br>      &#125;,<br>    &#125;,<br>  &#125;<br>&lt;&#x2F;script&gt;<br><br>&lt;style&gt;<br>&lt;&#x2F;style&gt;<br></code></pre></div></td></tr></table></figure><p>åœ¨<code>vue.config.js</code>ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; defineConfig &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@vue/cli-service&#x27;</span>)<br><span class="hljs-built_in">module</span>.exports = defineConfig(&#123;<br>  transpileDependencies: <span class="hljs-literal">true</span>,<br>  devServer: &#123;<br>    proxy: &#123;<br>      <span class="hljs-string">&#x27;/api&#x27;</span>: &#123;<br>        target: <span class="hljs-string">&#x27;http://localhost:3000&#x27;</span>,<br>        <span class="hljs-comment">// secure: false, // å¦‚æœæ˜¯httpsæ¥å£ï¼Œéœ€è¦é…ç½®è¿™ä¸ªå‚æ•°</span><br>        changeOrigin: <span class="hljs-literal">true</span>,<br>        pathRewrite: &#123;<br>          <span class="hljs-string">&#x27;^/api&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span><br>        &#125;<br>      &#125;<br>    &#125;,<br>  &#125;,<br>&#125;)<br></code></pre></div></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­çš„<code>devServer.proxy</code>å°±æ˜¯é…ç½®ä»£ç†ï¼Œå°†è¯·æ±‚è·¯å¾„ä¸­å¸¦æœ‰<code>/api</code>çš„è¯·æ±‚è·¯å¾„è½¬å‘åˆ°<code>target: 'http://localhost:3000'</code>ä¸Šï¼Œè‹¥åŸå§‹è¯·æ±‚è·¯å¾„ä¸º<code>http://localhost:8080/api/msg</code>ï¼Œåˆ™é€šè¿‡ä»£ç†è½¬å‘åçš„è¯·æ±‚è·¯å¾„ä¸º<code>http://localhost:3000/api/msg</code>ï¼Œä½†äº‹å®ä¸Šè¯·æ±‚è·¯å¾„ä¸­çš„<code>/api</code>åªæ˜¯ç”¨æ¥åŒ¹é…è½¬å‘è·¯å¾„çš„ï¼Œå¹¶ä¸æ˜¯å®é™…è¯·æ±‚è·¯å¾„ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥åœ¨çœŸæ­£å‘é€è¯·æ±‚æ—¶ï¼Œéœ€è¦å»æ‰<code>/api</code>ï¼Œæ‰€ç”¨çš„æ–¹æ³•å°±æ˜¯<code>pathRewrite</code>ï¼Œå°†è¯·æ±‚è·¯å¾„ä¸­çš„<code>/api</code>æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè¿™æ ·ç»è¿‡ä»£ç†è½¬å‘åçš„è¯·æ±‚è·¯å¾„ä¸º<code>http://localhost:3000/msg</code>ã€‚</p><h2 id="24-nginx"><a class="markdownIt-Anchor" href="#24-nginx"></a> 2.4 Nginx</h2><p>ä½¿ç”¨Nginxå¤„ç†è·¨åŸŸå’Œä½¿ç”¨Vue CLIå¤„ç†è·¨åŸŸåœ¨å†™æ³•ä¸Šéå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡ä¸­é—´æœåŠ¡å™¨è¿›è¡Œè¯·æ±‚è½¬å‘ï¼Œä½†Nginxå¤„ç†è·¨åŸŸçš„æ–¹æ³•å¾€å¾€æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå‰ç«¯ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;main&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><span class="javascript">    (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">send</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">      <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest()</span><br><span class="javascript">      xhr.open(<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;/api&#x27;</span>)</span><br>      xhr.send()<br><span class="javascript">      xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-comment">// xhr.readyState === 4è¡¨ç¤ºå“åº”å·²å®Œæˆï¼Œæ­¤æ—¶å¯ä»¥è·å–å¹¶ä½¿ç”¨æœåŠ¡å™¨çš„å“åº”ã€‚</span></span><br>        if (xhr.readyState === 4) &#123;<br><span class="javascript">          <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;main&#x27;</span>).innerHTML = xhr.response</span><br>        &#125;<br>      &#125;<br>    &#125;)()<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>è¯·æ±‚çš„è·¯å¾„åªéœ€è¦å†™<code>/api</code>å³å¯ï¼Œå†åœ¨Nginxä¸­çš„<code>conf/nginx.conf</code>æ–‡ä»¶ä¸­é…ç½®ä»£ç†ï¼š</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">server &#123;<br>    listen       3030;<br>    server_name  localhost;<br><br>    location /api/ &#123;<br>        proxy_pass  http://localhost:3000/;<br>    &#125;<br><br>    location / &#123;<br>        root   html;<br>        index  index.html index.htm;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>é€šè¿‡<code>proxy_pass</code>å°†è¯·æ±‚è·¯å¾„ä¸­å¸¦æœ‰<code>/api</code>çš„è¯·æ±‚è½¬å‘åˆ°<code>http://localhost:3000</code>ä¸Šã€‚</p></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a></div></div><p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p><div class="post-prevnext"><article class="post-prev col-6"></article><article class="post-next col-6"><a href="/2022/04/06/%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE%EF%BC%88%E6%80%BB%E7%BB%93%E7%AF%87%EF%BC%89/"><span class="hidden-mobile">åŸå‹ä¸åŸå‹é“¾ï¼ˆæ€»ç»“ç¯‡ï¼‰</span> <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"></div></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.2/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script><script>!function(t,i){(0,Fluid.plugins.typing)(i.getElementById("subtitle").title)}(window,document)</script><script src="/js/local-search.js"></script><script>$("#local-search-input").on("click",(function(){searchFunc("/local-search.xml","local-search-input","local-search-result")})),$("#modalSearch").on("shown.bs.modal",(function(){$("#local-search-input").focus()}))</script><script src="/js/boot.js"></script></body></html>