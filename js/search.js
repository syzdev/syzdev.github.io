var searchFunc=function(t,e,n){"use strict";var r=document.getElementById(e),s=document.getElementById(n);s.innerHTML="<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>",$.ajax({url:t,dataType:"xml",success:function(t){var e=$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get();s.innerHTML="",r.addEventListener("input",function(){var o='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);if(s.innerHTML="",!(this.value.trim().length<=0)){if(e.forEach(function(t){var n=!0;t.title&&""!==t.title.trim()||(t.title="Untitled");var r,s,e=t.title.trim(),a=e.toLowerCase(),l=t.content.trim().replace(/<[^>]+>/g,""),c=l.toLowerCase(),t=t.url,i=-1,u=-1;""!==c?h.forEach(function(t,e){r=a.indexOf(t),i=c.indexOf(t),r<0&&i<0?n=!1:(i<0&&(i=0),0==e&&(u=i))}):n=!1,n&&(o+="<li><a href='"+t+"' class='search-result-title'>"+e+"</a>",0<=u&&(t=u+80,(t=0==(e=(e=u-20)<0?0:e)?100:t)>l.length&&(t=l.length),s=l.substr(e,t),h.forEach(function(t){var e=new RegExp(t,"gi");s=s.replace(e,'<span class="search-keyword">'+t+"</span>")}),o+='<p class="search-result-abstract">'+s+"...</p>"),o+="</li>")}),-1===(o+="</ul>").indexOf("<li>"))return s.innerHTML="<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>";s.innerHTML=o}})}}),$(document).on("click","#search-close-icon",function(){$("#search-input").val(""),$("#search-result").html("")})},getSearchFile=function(){searchFunc("/search.xml","search-input","search-result")};