<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn.u1.huluxia.com/g3/M03/4D/84/wKgBOV6fGZWATbp6AAAML1Rr8NY150.png"><link rel="icon" href="https://cdn.u1.huluxia.com/g3/M03/4D/84/wKgBOV6fGZWATbp6AAAML1Rr8NY150.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content=""><meta name="author" content="syz"><meta name="keywords" content=""><title>MD5算法实现原理 - syzdev</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.6.0/styles/atom-one-dark.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"yoursite.com",root:"/",version:"1.8.10",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null}}}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><header style="height:35vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>😄 syzdev</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(https://cdn.u1.huluxia.com/g3/M02/4D/6C/wKgBOV6fEU2AXFGSAAJ7A1Fp7rw147.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="MD5算法实现原理"></span><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2020-04-16 21:14" pubdate>2020年4月16日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 3.4k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 49 分钟</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">MD5算法实现原理</h1><div class="markdown-body"><h1 id="1-md5-简介"><a class="markdownIt-Anchor" href="#1-md5-简介"></a> 1 MD5 简介</h1><p>信息摘要算法 MD5 (Message Digest 5)，数字 5 代表这是第五代算法，之前还有 MD1、MD2、MD3 和 MD4。MD5 是一种被广泛使用的密码散列函数，可以产生出一个 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>128</mn></mrow><annotation encoding="application/x-tex">128</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span></span> 位（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>16</mn></mrow><annotation encoding="application/x-tex">16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span></span></span></span> 字节）的散列值（hash value），用于确保信息传输完整一致。</p><p>MD5 算法的特征是不可逆性，并且在计算的时候所有的数据都参与了运算，其中任何一个数据变化了都会导致计算出来的 Hash 值完全不同，所以通常用来校验数据是否正确或用作身份验证。</p><h1 id="2-md5-实现步骤"><a class="markdownIt-Anchor" href="#2-md5-实现步骤"></a> 2 MD5 实现步骤</h1><h2 id="21-将明文变为-ascii-码"><a class="markdownIt-Anchor" href="#21-将明文变为-ascii-码"></a> 2.1 将明文变为 ASCII 码</h2><p>要加密的明文：<code>China,my great country</code>。<br>ASCII码：<code>43 68 69 6E 61 2C 6D 79 20 67 72 65 61 74 20 63 6F 75 6E 74 72 79</code></p><h2 id="22-填充和附加"><a class="markdownIt-Anchor" href="#22-填充和附加"></a> 2.2 填充和附加</h2><p>对数据进行<strong>填充</strong>的目的是使任意长度的数据能够被 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>512</mn></mrow><annotation encoding="application/x-tex">512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span> 整除，填充的首位是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>，其余位全部为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span>，填充后数据变成 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>N</mi><mo>∗</mo><mn>512</mn><mo>−</mo><mn>64</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(N*512-64)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">6</span><span class="mord">4</span><span class="mclose">)</span></span></span></span> 位（下图中假设 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>，则填充后要达到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>448</mn></mrow><annotation encoding="application/x-tex">448</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span><span class="mord">4</span><span class="mord">8</span></span></span></span> 位）。</p><p>减去 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>64</mn></mrow><annotation encoding="application/x-tex">64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">6</span><span class="mord">4</span></span></span></span> 是因为要在数据末尾<strong>附加</strong>长度项，如果数据的长度大于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>64</mn></mrow><annotation encoding="application/x-tex">64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">6</span><span class="mord">4</span></span></span></span> 位，则只取低 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>64</mn></mrow><annotation encoding="application/x-tex">64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">6</span><span class="mord">4</span></span></span></span> 位。通过填充和附加后，整个数据变为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>512</mn></mrow><annotation encoding="application/x-tex">512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span> 的整数倍。<br><img src="https://img-blog.csdnimg.cn/20200416164628242.jpg" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述" style="zoom:67%"><br>下面对数据进行填充和附加操作，数据为<code>4368696E612C6D7920677265617420636F756E747279</code>，这段数据长度为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>176</mn></mrow><annotation encoding="application/x-tex">176</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">7</span><span class="mord">6</span></span></span></span> 位（注意上述数据是用 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>16</mn></mrow><annotation encoding="application/x-tex">16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span></span></span></span> 进制表示的），由于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>176</mn><mo>&lt;</mo><mn>448</mn></mrow><annotation encoding="application/x-tex">176 &lt; 448</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68354em;vertical-align:-.0391em"></span><span class="mord">1</span><span class="mord">7</span><span class="mord">6</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span><span class="mord">4</span><span class="mord">8</span></span></span></span>，所以需要进行填充，共需填充 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>448</mn><mo>−</mo><mn>176</mn><mo>=</mo><mn>272</mn></mrow><annotation encoding="application/x-tex">448-176=272</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">4</span><span class="mord">4</span><span class="mord">8</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">7</span><span class="mord">6</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">7</span><span class="mord">2</span></span></span></span> 位，用 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>16</mn></mrow><annotation encoding="application/x-tex">16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span></span></span></span> 进制表示为 <code>80000....0000</code>（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>272</mn></mrow><annotation encoding="application/x-tex">272</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">7</span><span class="mord">2</span></span></span></span>位），再加上数据长度项 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>176</mn></mrow><annotation encoding="application/x-tex">176</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">7</span><span class="mord">6</span></span></span></span> 的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>16</mn></mrow><annotation encoding="application/x-tex">16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span></span></span></span> 进制为 <code>00B0</code>，但是要凑成 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>64</mn></mrow><annotation encoding="application/x-tex">64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">6</span><span class="mord">4</span></span></span></span> 位，所以最后附加 <code>B000000000000000</code>。</p><p>填充和附加后的数据为：<code>4368696E612C6D7920677265617420636F756E747279</code> <code>80000....0000</code>（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>272</mn></mrow><annotation encoding="application/x-tex">272</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">7</span><span class="mord">2</span></span></span></span>位）<code>B000000000000000</code>。总长度刚好为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>512</mn></mrow><annotation encoding="application/x-tex">512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span> 位。</p><h2 id="23-分组"><a class="markdownIt-Anchor" href="#23-分组"></a> 2.3 分组</h2><p>将数据按每组 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>512</mn></mrow><annotation encoding="application/x-tex">512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span> 位进行分组，每组内再分成 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>16</mn></mrow><annotation encoding="application/x-tex">16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span></span></span></span> 组，每组 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>32</mn></mrow><annotation encoding="application/x-tex">32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mord">2</span></span></span></span> 位。</p><p>上述数据按要求分组后如下表，并把每组数据保存在数组 <code>x</code> 中，表中的 <code>#</code> 代表在数组中的下标：</p><table><thead><tr><th>#</th><th>数据</th></tr></thead><tbody><tr><td>0</td><td><code>6E696843</code></td></tr><tr><td>1</td><td><code>796D2C61</code></td></tr><tr><td>2</td><td><code>65726720</code></td></tr><tr><td>3</td><td><code>63207461</code></td></tr><tr><td>4</td><td><code>746E756F</code></td></tr><tr><td>…</td><td>…</td></tr><tr><td>11</td><td><code>00000000</code></td></tr><tr><td>12</td><td><code>00000000</code></td></tr><tr><td>13</td><td><code>00000000</code></td></tr><tr><td>14</td><td><code>000000B0</code></td></tr><tr><td>15</td><td><code>00000000</code></td></tr></tbody></table><h2 id="24-预处理"><a class="markdownIt-Anchor" href="#24-预处理"></a> 2.4 预处理</h2><p>首先要确定 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span> 个链接变量 <code>A、B、C、D</code>，每个变量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>32</mn></mrow><annotation encoding="application/x-tex">32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mord">2</span></span></span></span> 位。</p><table><thead><tr><th>链接变量</th><th>存储形式值</th></tr></thead><tbody><tr><td><code>A</code></td><td><code>0x67452301</code></td></tr><tr><td><code>B</code></td><td><code>0xEFCDAB89</code></td></tr><tr><td><code>C</code></td><td><code>0x98BADCFE</code></td></tr><tr><td><code>D</code></td><td><code>0x10325476</code></td></tr></tbody></table><p>这四个变量看似毫无章法，其实是有规律的，由于 Windows 是基于 <strong>Little Endian</strong> 的，即低位字节排放在内存的低地址端，高位字节排放在内存的高地址端，所以我们在定义这四个变量的值的时候要按它们在内存中的存储形式进行定义，实际上这四个变量的逻辑形式是：</p><table><thead><tr><th>链接变量</th><th>逻辑形式值</th></tr></thead><tbody><tr><td><code>A</code></td><td><code>0x01234567</code></td></tr><tr><td><code>B</code></td><td><code>0x89ABCDEF</code></td></tr><tr><td><code>C</code></td><td><code>0xFEDCBA98</code></td></tr><tr><td><code>D</code></td><td><code>0x76543210</code></td></tr></tbody></table><p>仔细观察后，规律就很明显了。</p><h2 id="25-循环加工"><a class="markdownIt-Anchor" href="#25-循环加工"></a> 2.5 循环加工</h2><p>当第一轮的第一步开始处理时，将这 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span> 个变量先分别赋值到另外 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span> 个变量 <code>oldA、oldB、oldC、oldD</code> 中，以第一轮第一步为例，对应第一轮第一步的操作函数为 <code>md5ff(a, b, c, d, x[0], 7, 0xD76AA478)</code>（<code>7</code> 用于循环左移，<code>0xD76AA478</code> 为正弦补充值），首先将 <code>b、c、d</code> 经过非线性函数 <code>(b&amp;c) | (not(b)&amp;d)</code> 计算得到<code>98BADCFE</code>后，再将这个值加上 <code>A、x[0]</code> 和 <code>0xD76AA478</code>，即 <code>67452301 + 98BADCFE + 6E696843 + D76AA478 = 45D40CBA</code>。</p><p>再将相加结果 <code>45D40CBA</code> 循环左移七位得 <code>EA065D22</code>，再加上链接变量 <code>B</code> 的值，即 <code>EA065D22 + EFCDAB89 = D9D408AB</code>，最后把这个值赋值给链接变量 <code>A</code>。</p><p>依次类推，经过 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span> 轮操作，共 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>64</mn></mrow><annotation encoding="application/x-tex">64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">6</span><span class="mord">4</span></span></span></span> 个步骤后， <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span> 个链接变量变为：</p><table><thead><tr><th>链接变量</th><th>存储形式值</th></tr></thead><tbody><tr><td><code>A</code></td><td><code>0xD32A3F0D</code></td></tr><tr><td><code>B</code></td><td><code>0x0E63C780</code></td></tr><tr><td><code>C</code></td><td><code>0x469E5215</code></td></tr><tr><td><code>D</code></td><td><code>0x65C53CCA</code></td></tr></tbody></table><p>接下来要将原 <code>A、B、C、D</code> 的值和上表中处理后的<code>A、B、C、D</code> 值相加求和，将和分别赋值给<code>A、B、C、D</code>，这个时候就用到了之前的 <code>oldA、oldB、oldC、oldD</code> ，具体操作以 <code>A</code> 为例，将 <code>A</code> 与 <code>oldA</code> 相加，即 <code>D32A3F0D + 67452301 = 3A6F620E</code>，再将和赋值给 <code>A</code>。全部求和后结果如下表：</p><table><thead><tr><th>链接变量</th><th>存储形式值</th></tr></thead><tbody><tr><td><code>A</code></td><td><code>0x3A6F620E</code></td></tr><tr><td><code>B</code></td><td><code>0xFE317309</code></td></tr><tr><td><code>C</code></td><td><code>0xDF592F13</code></td></tr><tr><td><code>D</code></td><td><code>0x75F79140</code></td></tr></tbody></table><p>最后算得的散列值为：<code>0E626F3A097331FE132F59DF4091F775</code>。</p><h1 id="3-blueimp-md5-源码"><a class="markdownIt-Anchor" href="#3-blueimp-md5-源码"></a> 3 blueimp-md5 源码</h1><p><a target="_blank" rel="noopener" href="https://github.com/blueimp/JavaScript-MD5">blueimp-md5</a> 是由 blueimp 实现的 JavaScript MD5 算法。阅读源码后发现他们用了很多位运算来实现整个过程，有的地方生涩难懂。源码中一共提供了 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span> 种 API：</p><ol><li>给定一个字符串，计算得出它的 MD5 哈希值，如：<code>var hash = md5('value')</code>；</li><li>给定一个字符串，计算得出它的 HMAC-MD5 哈希值，如：<code>var hash = md5(&quot;value&quot;, &quot;key&quot;)</code>；</li><li>给定一个字符串，计算其原始 MD5 哈希值，如：<code>var hash = md5('value', null, true)</code>；</li><li>给定一个字符串和一个键值，计算其原始 HMAC-MD5 哈希值，如：<code>var hash = md5(&quot;value&quot;, &quot;key&quot;, true)</code></li></ol><p>最常用的还是第一个，下面列出 blueimp-md5 源码实现过程，只截取了关键部分。</p><p>将字符串编码为 <code>UTF-8</code>。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* Encode a string as utf-8</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">str2rstrUTF8</span> (<span class="hljs-params">input</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">unescape</span>(<span class="hljs-built_in">encodeURIComponent</span>(input))<br>&#125;<br></code></pre></div></td></tr></table></figure><p>将原始字符串转换为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>16</mn></mrow><annotation encoding="application/x-tex">16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span></span></span></span> 进制。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* Convert a raw string to a hex string</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rstr2hex</span> (<span class="hljs-params">input</span>) </span>&#123;<br>  <span class="hljs-keyword">var</span> hexTab = <span class="hljs-string">&#x27;0123456789abcdef&#x27;</span><br>  <span class="hljs-keyword">var</span> output = <span class="hljs-string">&#x27;&#x27;</span><br>  <span class="hljs-keyword">var</span> x<br>  <span class="hljs-keyword">var</span> i<br>  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; input.length; i += <span class="hljs-number">1</span>) &#123;<br>    x = input.charCodeAt(i)<br>    output += hexTab.charAt((x &gt;&gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0x0f</span>) + hexTab.charAt(x &amp; <span class="hljs-number">0x0f</span>)<br>  &#125;<br>  <span class="hljs-keyword">return</span> output<br>&#125;<br></code></pre></div></td></tr></table></figure><p>四个非线性函数。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* These functions implement the four basic operations the algorithm uses.</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">md5cmn</span> (<span class="hljs-params">q, a, b, x, s, t</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">md5ff</span> (<span class="hljs-params">a, b, c, d, x, s, t</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> md5cmn((b &amp; c) | (~b &amp; d), a, b, x, s, t)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">md5gg</span> (<span class="hljs-params">a, b, c, d, x, s, t</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> md5cmn((b &amp; d) | (c &amp; ~d), a, b, x, s, t)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">md5hh</span> (<span class="hljs-params">a, b, c, d, x, s, t</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> md5cmn(b ^ c ^ d, a, b, x, s, t)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">md5ii</span> (<span class="hljs-params">a, b, c, d, x, s, t</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> md5cmn(c ^ (b | ~d), a, b, x, s, t)<br>&#125;<br></code></pre></div></td></tr></table></figure><p>循环左移。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* Bitwise rotate a 32-bit number to the left.</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bitRotateLeft</span> (<span class="hljs-params">num, cnt</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> (num &lt;&lt; cnt) | (num &gt;&gt;&gt; (<span class="hljs-number">32</span> - cnt))<br>&#125;<br></code></pre></div></td></tr></table></figure><p>求和，生成新的链接变量。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* Add integers, wrapping at 2^32. This uses 16-bit operations internally</span><br><span class="hljs-comment">* to work around bugs in some JS interpreters.</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeAdd</span> (<span class="hljs-params">x, y</span>) </span>&#123;<br>  <span class="hljs-keyword">var</span> lsw = (x &amp; <span class="hljs-number">0xffff</span>) + (y &amp; <span class="hljs-number">0xffff</span>)<br>  <span class="hljs-keyword">var</span> msw = (x &gt;&gt; <span class="hljs-number">16</span>) + (y &gt;&gt; <span class="hljs-number">16</span>) + (lsw &gt;&gt; <span class="hljs-number">16</span>)<br>  <span class="hljs-keyword">return</span> (msw &lt;&lt; <span class="hljs-number">16</span>) | (lsw &amp; <span class="hljs-number">0xffff</span>)<br>&#125;<br></code></pre></div></td></tr></table></figure><p>计算 MD5 哈希值，注意该函数中的 <code>a、b、c、d</code> 和 非线性函数中的数（正弦补充值）都是以十进制表示的。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* Calculate the MD5 of an array of little-endian words, and a bit length.</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">binlMD5</span> (<span class="hljs-params">x, len</span>) </span>&#123;<br>  <span class="hljs-comment">/* append padding */</span><br>  x[len &gt;&gt; <span class="hljs-number">5</span>] |= <span class="hljs-number">0x80</span> &lt;&lt; (len % <span class="hljs-number">32</span>)<br>  x[((len + <span class="hljs-number">64</span>) &gt;&gt;&gt; <span class="hljs-number">9</span> &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">14</span>] = len<br><br>  <span class="hljs-keyword">var</span> i<br>  <span class="hljs-keyword">var</span> olda<br>  <span class="hljs-keyword">var</span> oldb<br>  <span class="hljs-keyword">var</span> oldc<br>  <span class="hljs-keyword">var</span> oldd<br>  <span class="hljs-keyword">var</span> a = <span class="hljs-number">1732584193</span><br>  <span class="hljs-keyword">var</span> b = -<span class="hljs-number">271733879</span><br>  <span class="hljs-keyword">var</span> c = -<span class="hljs-number">1732584194</span><br>  <span class="hljs-keyword">var</span> d = <span class="hljs-number">271733878</span><br><br>  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; x.length; i += <span class="hljs-number">16</span>) &#123;<br>    olda = a<br>    oldb = b<br>    oldc = c<br>    oldd = d<br><br>    a = md5ff(a, b, c, d, x[i], <span class="hljs-number">7</span>, -<span class="hljs-number">680876936</span>)<br>    d = md5ff(d, a, b, c, x[i + <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, -<span class="hljs-number">389564586</span>)<br>    c = md5ff(c, d, a, b, x[i + <span class="hljs-number">2</span>], <span class="hljs-number">17</span>, <span class="hljs-number">606105819</span>)<br>    b = md5ff(b, c, d, a, x[i + <span class="hljs-number">3</span>], <span class="hljs-number">22</span>, -<span class="hljs-number">1044525330</span>)<br>    a = md5ff(a, b, c, d, x[i + <span class="hljs-number">4</span>], <span class="hljs-number">7</span>, -<span class="hljs-number">176418897</span>)<br>    d = md5ff(d, a, b, c, x[i + <span class="hljs-number">5</span>], <span class="hljs-number">12</span>, <span class="hljs-number">1200080426</span>)<br>    c = md5ff(c, d, a, b, x[i + <span class="hljs-number">6</span>], <span class="hljs-number">17</span>, -<span class="hljs-number">1473231341</span>)<br>    b = md5ff(b, c, d, a, x[i + <span class="hljs-number">7</span>], <span class="hljs-number">22</span>, -<span class="hljs-number">45705983</span>)<br>    a = md5ff(a, b, c, d, x[i + <span class="hljs-number">8</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1770035416</span>)<br>    d = md5ff(d, a, b, c, x[i + <span class="hljs-number">9</span>], <span class="hljs-number">12</span>, -<span class="hljs-number">1958414417</span>)<br>    c = md5ff(c, d, a, b, x[i + <span class="hljs-number">10</span>], <span class="hljs-number">17</span>, -<span class="hljs-number">42063</span>)<br>    b = md5ff(b, c, d, a, x[i + <span class="hljs-number">11</span>], <span class="hljs-number">22</span>, -<span class="hljs-number">1990404162</span>)<br>    a = md5ff(a, b, c, d, x[i + <span class="hljs-number">12</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1804603682</span>)<br>    d = md5ff(d, a, b, c, x[i + <span class="hljs-number">13</span>], <span class="hljs-number">12</span>, -<span class="hljs-number">40341101</span>)<br>    c = md5ff(c, d, a, b, x[i + <span class="hljs-number">14</span>], <span class="hljs-number">17</span>, -<span class="hljs-number">1502002290</span>)<br>    b = md5ff(b, c, d, a, x[i + <span class="hljs-number">15</span>], <span class="hljs-number">22</span>, <span class="hljs-number">1236535329</span>)<br><br>    a = md5gg(a, b, c, d, x[i + <span class="hljs-number">1</span>], <span class="hljs-number">5</span>, -<span class="hljs-number">165796510</span>)<br>    d = md5gg(d, a, b, c, x[i + <span class="hljs-number">6</span>], <span class="hljs-number">9</span>, -<span class="hljs-number">1069501632</span>)<br>    c = md5gg(c, d, a, b, x[i + <span class="hljs-number">11</span>], <span class="hljs-number">14</span>, <span class="hljs-number">643717713</span>)<br>    b = md5gg(b, c, d, a, x[i], <span class="hljs-number">20</span>, -<span class="hljs-number">373897302</span>)<br>    a = md5gg(a, b, c, d, x[i + <span class="hljs-number">5</span>], <span class="hljs-number">5</span>, -<span class="hljs-number">701558691</span>)<br>    d = md5gg(d, a, b, c, x[i + <span class="hljs-number">10</span>], <span class="hljs-number">9</span>, <span class="hljs-number">38016083</span>)<br>    c = md5gg(c, d, a, b, x[i + <span class="hljs-number">15</span>], <span class="hljs-number">14</span>, -<span class="hljs-number">660478335</span>)<br>    b = md5gg(b, c, d, a, x[i + <span class="hljs-number">4</span>], <span class="hljs-number">20</span>, -<span class="hljs-number">405537848</span>)<br>    a = md5gg(a, b, c, d, x[i + <span class="hljs-number">9</span>], <span class="hljs-number">5</span>, <span class="hljs-number">568446438</span>)<br>    d = md5gg(d, a, b, c, x[i + <span class="hljs-number">14</span>], <span class="hljs-number">9</span>, -<span class="hljs-number">1019803690</span>)<br>    c = md5gg(c, d, a, b, x[i + <span class="hljs-number">3</span>], <span class="hljs-number">14</span>, -<span class="hljs-number">187363961</span>)<br>    b = md5gg(b, c, d, a, x[i + <span class="hljs-number">8</span>], <span class="hljs-number">20</span>, <span class="hljs-number">1163531501</span>)<br>    a = md5gg(a, b, c, d, x[i + <span class="hljs-number">13</span>], <span class="hljs-number">5</span>, -<span class="hljs-number">1444681467</span>)<br>    d = md5gg(d, a, b, c, x[i + <span class="hljs-number">2</span>], <span class="hljs-number">9</span>, -<span class="hljs-number">51403784</span>)<br>    c = md5gg(c, d, a, b, x[i + <span class="hljs-number">7</span>], <span class="hljs-number">14</span>, <span class="hljs-number">1735328473</span>)<br>    b = md5gg(b, c, d, a, x[i + <span class="hljs-number">12</span>], <span class="hljs-number">20</span>, -<span class="hljs-number">1926607734</span>)<br><br>    a = md5hh(a, b, c, d, x[i + <span class="hljs-number">5</span>], <span class="hljs-number">4</span>, -<span class="hljs-number">378558</span>)<br>    d = md5hh(d, a, b, c, x[i + <span class="hljs-number">8</span>], <span class="hljs-number">11</span>, -<span class="hljs-number">2022574463</span>)<br>    c = md5hh(c, d, a, b, x[i + <span class="hljs-number">11</span>], <span class="hljs-number">16</span>, <span class="hljs-number">1839030562</span>)<br>    b = md5hh(b, c, d, a, x[i + <span class="hljs-number">14</span>], <span class="hljs-number">23</span>, -<span class="hljs-number">35309556</span>)<br>    a = md5hh(a, b, c, d, x[i + <span class="hljs-number">1</span>], <span class="hljs-number">4</span>, -<span class="hljs-number">1530992060</span>)<br>    d = md5hh(d, a, b, c, x[i + <span class="hljs-number">4</span>], <span class="hljs-number">11</span>, <span class="hljs-number">1272893353</span>)<br>    c = md5hh(c, d, a, b, x[i + <span class="hljs-number">7</span>], <span class="hljs-number">16</span>, -<span class="hljs-number">155497632</span>)<br>    b = md5hh(b, c, d, a, x[i + <span class="hljs-number">10</span>], <span class="hljs-number">23</span>, -<span class="hljs-number">1094730640</span>)<br>    a = md5hh(a, b, c, d, x[i + <span class="hljs-number">13</span>], <span class="hljs-number">4</span>, <span class="hljs-number">681279174</span>)<br>    d = md5hh(d, a, b, c, x[i], <span class="hljs-number">11</span>, -<span class="hljs-number">358537222</span>)<br>    c = md5hh(c, d, a, b, x[i + <span class="hljs-number">3</span>], <span class="hljs-number">16</span>, -<span class="hljs-number">722521979</span>)<br>    b = md5hh(b, c, d, a, x[i + <span class="hljs-number">6</span>], <span class="hljs-number">23</span>, <span class="hljs-number">76029189</span>)<br>    a = md5hh(a, b, c, d, x[i + <span class="hljs-number">9</span>], <span class="hljs-number">4</span>, -<span class="hljs-number">640364487</span>)<br>    d = md5hh(d, a, b, c, x[i + <span class="hljs-number">12</span>], <span class="hljs-number">11</span>, -<span class="hljs-number">421815835</span>)<br>    c = md5hh(c, d, a, b, x[i + <span class="hljs-number">15</span>], <span class="hljs-number">16</span>, <span class="hljs-number">530742520</span>)<br>    b = md5hh(b, c, d, a, x[i + <span class="hljs-number">2</span>], <span class="hljs-number">23</span>, -<span class="hljs-number">995338651</span>)<br><br>    a = md5ii(a, b, c, d, x[i], <span class="hljs-number">6</span>, -<span class="hljs-number">198630844</span>)<br>    d = md5ii(d, a, b, c, x[i + <span class="hljs-number">7</span>], <span class="hljs-number">10</span>, <span class="hljs-number">1126891415</span>)<br>    c = md5ii(c, d, a, b, x[i + <span class="hljs-number">14</span>], <span class="hljs-number">15</span>, -<span class="hljs-number">1416354905</span>)<br>    b = md5ii(b, c, d, a, x[i + <span class="hljs-number">5</span>], <span class="hljs-number">21</span>, -<span class="hljs-number">57434055</span>)<br>    a = md5ii(a, b, c, d, x[i + <span class="hljs-number">12</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1700485571</span>)<br>    d = md5ii(d, a, b, c, x[i + <span class="hljs-number">3</span>], <span class="hljs-number">10</span>, -<span class="hljs-number">1894986606</span>)<br>    c = md5ii(c, d, a, b, x[i + <span class="hljs-number">10</span>], <span class="hljs-number">15</span>, -<span class="hljs-number">1051523</span>)<br>    b = md5ii(b, c, d, a, x[i + <span class="hljs-number">1</span>], <span class="hljs-number">21</span>, -<span class="hljs-number">2054922799</span>)<br>    a = md5ii(a, b, c, d, x[i + <span class="hljs-number">8</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1873313359</span>)<br>    d = md5ii(d, a, b, c, x[i + <span class="hljs-number">15</span>], <span class="hljs-number">10</span>, -<span class="hljs-number">30611744</span>)<br>    c = md5ii(c, d, a, b, x[i + <span class="hljs-number">6</span>], <span class="hljs-number">15</span>, -<span class="hljs-number">1560198380</span>)<br>    b = md5ii(b, c, d, a, x[i + <span class="hljs-number">13</span>], <span class="hljs-number">21</span>, <span class="hljs-number">1309151649</span>)<br>    a = md5ii(a, b, c, d, x[i + <span class="hljs-number">4</span>], <span class="hljs-number">6</span>, -<span class="hljs-number">145523070</span>)<br>    d = md5ii(d, a, b, c, x[i + <span class="hljs-number">11</span>], <span class="hljs-number">10</span>, -<span class="hljs-number">1120210379</span>)<br>    c = md5ii(c, d, a, b, x[i + <span class="hljs-number">2</span>], <span class="hljs-number">15</span>, <span class="hljs-number">718787259</span>)<br>    b = md5ii(b, c, d, a, x[i + <span class="hljs-number">9</span>], <span class="hljs-number">21</span>, -<span class="hljs-number">343485551</span>)<br><br>    a = safeAdd(a, olda)<br>    b = safeAdd(b, oldb)<br>    c = safeAdd(c, oldc)<br>    d = safeAdd(d, oldd)<br>  &#125;<br>  <span class="hljs-keyword">return</span> [a, b, c, d]<br>&#125;<br></code></pre></div></td></tr></table></figure><h1 id="4-遗留的问题"><a class="markdownIt-Anchor" href="#4-遗留的问题"></a> 4 遗留的问题</h1><h2 id="41-四个非线性函数是如何设计的"><a class="markdownIt-Anchor" href="#41-四个非线性函数是如何设计的"></a> 4.1 四个非线性函数是如何设计的</h2><p>在循环加工中，<code>(b&amp;c) | (not(b)&amp;d) = 98BADCFE</code>，即为一次非线性函数计算。</p><table><thead><tr><th>#</th><th>非线性函数</th></tr></thead><tbody><tr><td>1</td><td><code>F(X,Y,Z) = (X &amp; Y) | ((~X) &amp; Z);</code></td></tr><tr><td>2</td><td><code>G(X,Y,Z) = (X &amp; Z) | (Y &amp; (~Z));</code></td></tr><tr><td>3</td><td><code>H(X,Y,Z) = X ^ Y ^ Z;</code></td></tr><tr><td>4</td><td><code>I(X,Y,Z) = Y ^ (X | (~Z));</code></td></tr></tbody></table><p>这四个非线性函数分别被封装到四个操作函数中，即循环加工中的 <code>md5ff</code> 函数就为操作函数之一，还有 <code>md5gg</code>、<code>md5hh</code> 和 <code>md5ii</code>。</p><h2 id="42-循环左移偏移量是如何设计的"><a class="markdownIt-Anchor" href="#42-循环左移偏移量是如何设计的"></a> 4.2 循环左移偏移量是如何设计的</h2><p>四个操作函数中，都附带了参数作为循环左移偏移量，阅读代码后，发现循环左移偏移量分为如下四组：</p><table><thead><tr><th>#</th><th>左循环偏移量</th></tr></thead><tbody><tr><td>1</td><td><code>7, 12, 17, 22</code></td></tr><tr><td>2</td><td><code>5, 9, 14, 20</code></td></tr><tr><td>3</td><td><code>4, 11, 16, 23</code></td></tr><tr><td>4</td><td><code>6, 10, 15, 21</code></td></tr></tbody></table><h2 id="43-正弦补充值是如何设计的"><a class="markdownIt-Anchor" href="#43-正弦补充值是如何设计的"></a> 4.3 正弦补充值是如何设计的</h2><p>四个操作函数中，最后一个参数为正弦补充值，下面是十进制表示：</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">a = md5ff(a, b, c, d, x[i], <span class="hljs-number">7</span>, -<span class="hljs-number">680876936</span>)<br>d = md5ff(d, a, b, c, x[i + <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, -<span class="hljs-number">389564586</span>)<br>      ...<br></code></pre></div></td></tr></table></figure><p>转换为十六进制表示为：</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">a = md5ff(a, b, c, d, x[i], <span class="hljs-number">7</span>, <span class="hljs-number">0xD76AA478</span>)<br>d = md5ff(d, a, b, c, x[i + <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, <span class="hljs-number">0xE8C7B756</span>)<br>      ...<br></code></pre></div></td></tr></table></figure><h1 id="5-md5在线计算"><a class="markdownIt-Anchor" href="#5-md5在线计算"></a> 5 MD5在线计算</h1><iframe height="360" width="100%" src="https://syzdev.gitee.io/page/p/md5.html" frameborder="0"></iframe><h1 id="6-总结"><a class="markdownIt-Anchor" href="#6-总结"></a> 6 总结</h1><p>目前只对 MD5 算法有个初步的了解，而上面遗留的问题正是 MD5 算法的核心实现部分，不禁让人感叹算法设计者的脑洞。</p><p>从个人目前的认知来看，算法设计的数据和计算函数，目的只有一个，就是想方设法的打乱数据并直接让每一位都参与进来，这也就是为什么任何一位的变化，都会影响最后的哈希值，如明文：<code>Hello syzdev</code>的哈希值为：<code>704558b48d6370fb71533d5ae50727b4</code>，在改动其中一个字母后明文变为 <code>Hallo syzdev</code> ，其产生的哈希值为：<code>2433084e178a2331d40c2ea16fd664fa</code>，这两个哈希值看起来找不出有任何关联，即使两者的明文仅有一个字母差别。</p><p>MD5 将整个数据拆分成多个组，再由每个组内分别计算累加，有些资料将分组过程分为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span></span></span></span> 步，即先将整个数据按 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>512</mn></mrow><annotation encoding="application/x-tex">512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span> 位分块，再把每个 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>512</mn></mrow><annotation encoding="application/x-tex">512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span> 位分成 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span> 个 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>128</mn></mrow><annotation encoding="application/x-tex">128</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span></span> 位数据块，最后将 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span> 个 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>128</mn></mrow><annotation encoding="application/x-tex">128</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span></span> 位的数据块依次送到不同的散列函数进行 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span> 轮计算。每一轮又都按 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>32</mn></mrow><annotation encoding="application/x-tex">32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mord">2</span></span></span></span> 位的小数据块进行复杂的运算，一直到最后计算出 MD5 报文摘要代码，这也就是为什么 MD5 能把不定长的数据最后都变成 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>128</mn></mrow><annotation encoding="application/x-tex">128</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span></span> 位的哈希值。</p><p>可以发现，MD5 的处理函数，包括非线性函数和操作函数都包含了多个参数，而且还是变动的参数，这也就保证了 MD5 是个不可逆的算法。举个简单的例子，如有函数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>5</mn><mo>∗</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">z=f(x)=5*x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">x</span></span></span></span>，此时知道 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">z=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">0</span></span></span></span>，那么显然得到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">x=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span></span></span></span>；如函数为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>∗</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">z=f(x, y)=x*y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.46528em;vertical-align:0"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span></span>，此时知道 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">z=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">0</span></span></span></span>，这种情况下是无法推断出 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">x</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span></span> 的值的，这样也就保证了 MD5 算法具有不可逆性。</p><p>正是因为 MD5 算法具有不可逆性，所以目前存在的破解算法都不是恢复明文，而是只要能找到能生成此摘要的其中一个原文即可，这种破解方法叫做“碰撞”。如 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>=</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">H(A) = M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.08125em">H</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.10903em">M</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">H(B) = M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.08125em">H</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.10903em">M</span></span></span></span>，则称 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span></span></span></span> 为破解结果，此时 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault">A</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span></span></span></span> 可能相等，也可能不等。</p></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p><div class="post-prevnext"><article class="post-prev col-6"><a href="/2020/05/01/HTTPS%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">HTTPS是如何工作的</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2020/03/21/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0%EF%BC%9A%E5%A4%A7%E5%AE%B9%E9%87%8F%E5%AD%98%E5%82%A8/"><span class="hidden-mobile">操作系统原理第十一章：大容量存储</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"></div></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.2/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script><script>!function(t,i){(0,Fluid.plugins.typing)(i.getElementById("subtitle").title)}(window,document)</script><script src="/js/local-search.js"></script><script>$("#local-search-input").on("click",(function(){searchFunc("/local-search.xml","local-search-input","local-search-result")})),$("#modalSearch").on("shown.bs.modal",(function(){$("#local-search-input").focus()}))</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script src="/js/boot.js"></script></body></html>